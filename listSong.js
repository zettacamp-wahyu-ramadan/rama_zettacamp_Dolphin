// List song
const listSong = [
  {
    id: 1,
    title: 'Shape of You',
    artist: 'Ed Sheeran',
    genre: 'Pop',
    duration: '3.54',
    isPlay: false,
  },
  {
    id: 2,
    title: 'Bohemian Rhapsody',
    artist: 'Queen',
    genre: 'Rock',
    duration: '5.55',
    isPlay: false,
  },
  {
    id: 3,
    title: 'Rolling in the Deep',
    artist: 'Adele',
    genre: 'Pop',
    duration: '3.48',
    isPlay: false,
  },
  {
    id: 4,
    title: 'Billie Jean',
    artist: 'Michael Jackson',
    genre: 'Pop',
    duration: '4.54',
    isPlay: false,
  },
  {
    id: 5,
    title: 'Hotel California',
    artist: 'Eagles',
    genre: 'Rock',
    duration: '6.30',
    isPlay: false,
  },
  {
    id: 6,
    title: 'Uptown Funk',
    artist: 'Mark Ronson ft. Bruno Mars',
    genre: 'Funk',
    duration: '4.30',
    isPlay: false,
  },
  {
    id: 7,
    title: 'Wonderwall',
    artist: 'Oasis',
    genre: 'Rock',
    duration: '4.18',
    isPlay: false,
  },
  {
    id: 8,
    title: 'Shape of My Heart',
    artist: 'Sting',
    genre: 'Pop',
    duration: '4.38',
    isPlay: false,
  },
  {
    id: 9,
    title: 'Smooth',
    artist: 'Santana ft. Rob Thomas',
    genre: 'Rock',
    duration: '4.00',
    isPlay: false,
  },
  {
    id: 10,
    title: 'Hello',
    artist: 'Adele',
    genre: 'Pop',
    duration: '4.55',
    isPlay: false,
  },
  {
    id: 11,
    title: "Livin' on a Prayer",
    artist: 'Bon Jovi',
    genre: 'Rock',
    duration: '4.10',
    isPlay: false,
  },
  {
    id: 12,
    title: 'Dancing Queen',
    artist: 'ABBA',
    genre: 'Pop',
    duration: '3.52',
    isPlay: false,
  },
  {
    id: 13,
    title: "Sweet Child o' Mine",
    artist: "Guns N' Roses",
    genre: 'Rock',
    duration: '5.55',
    isPlay: false,
  },
  {
    id: 14,
    title: "Stayin' Alive",
    artist: 'Bee Gees',
    genre: 'Disco',
    duration: '4.45',
    isPlay: false,
  },
  {
    id: 15,
    title: 'Thinking Out Loud',
    artist: 'Ed Sheeran',
    genre: 'Pop',
    duration: '4.41',
    isPlay: false,
  },
  {
    id: 16,
    title: 'I Want to Hold Your Hand',
    artist: 'The Beatles',
    genre: 'Rock',
    duration: '2.24',
    isPlay: false,
  },
  {
    id: 17,
    title: 'All of Me',
    artist: 'John Legend',
    genre: 'Pop',
    duration: '4.29',
    isPlay: false,
  },
  {
    id: 18,
    title: 'Somebody to Love',
    artist: 'Queen',
    genre: 'Rock',
    duration: '4.56',
    isPlay: false,
  },
  {
    id: 19,
    title: 'Stay',
    artist: 'Rihanna ft. Mikky Ekko',
    genre: 'Pop',
    duration: '4.00',
    isPlay: false,
  },
  {
    id: 20,
    title: 'Highway to Hell',
    artist: 'AC/DC',
    genre: 'Rock',
    duration: '3.28',
    isPlay: false,
  },
  {
    id: 21,
    title: 'Radioactive',
    artist: 'Imagine Dragons',
    genre: 'Pop',
    duration: '3.07',
    isPlay: false,
  },
  {
    id: 22,
    title: "Don't Stop Believin'",
    artist: 'Journey',
    genre: 'Rock',
    duration: '4.09',
    isPlay: false,
  },
  {
    id: 23,
    title: 'Chandelier',
    artist: 'Sia',
    genre: 'Pop',
    duration: '3.36',
    isPlay: false,
  },
  {
    id: 24,
    title: 'Yesterday',
    artist: 'The Beatles',
    genre: 'Rock',
    duration: '2.05',
    isPlay: false,
  },
  {
    id: 25,
    title: "Can't Help Falling in Love",
    artist: 'Elvis Presley',
    genre: 'Rock',
    duration: '3.00',
    isPlay: false,
  },
  {
    id: 26,
    title: 'Happy',
    artist: 'Pharrell Williams',
    genre: 'Pop',
    duration: '3.53',
    isPlay: false,
  },
  {
    id: 27,
    title: 'Piano Man',
    artist: 'Billy Joel',
    genre: 'Pop',
    duration: '5.37',
    isPlay: false,
  },
  {
    id: 28,
    title: 'Stairway to Heaven',
    artist: 'Led Zeppelin',
    genre: 'Rock',
    duration: '8.02',
    isPlay: false,
  },
  {
    id: 29,
    title: 'Someone Like You',
    artist: 'Adele',
    genre: 'Pop',
    duration: '4.45',
    isPlay: false,
  },
  {
    id: 30,
    title: 'Hallelujah',
    artist: 'Leonard Cohen',
    genre: 'Folk',
    duration: '4.39',
    isPlay: false,
  },
  {
    id: 31,
    title: 'Radio Ga Ga',
    artist: 'Queen',
    genre: 'Rock',
    duration: '5.43',
    isPlay: false,
  },
  {
    id: 32,
    title: 'Hey Jude',
    artist: 'The Beatles',
    genre: 'Rock',
    duration: '7.11',
    isPlay: false,
  },
  {
    id: 33,
    title: 'Thriller',
    artist: 'Michael Jackson',
    genre: 'Pop',
    duration: '5.57',
    isPlay: false,
  },
  {
    id: 34,
    title: 'Back in Black',
    artist: 'AC/DC',
    genre: 'Rock',
    duration: '4.15',
    isPlay: false,
  },
];

// const listSong = [
//   {
//     id: 1,
//     title: 'Shape of You',
//     artist: 'Ed Sheeran',
//     genre: 'Pop',
//     duration: '29.55',
//     isPlay: false,
//   },
//   {
//     id: 2,
//     title: 'Bohemian Rhapsody',
//     artist: 'Queen',
//     genre: 'Rock',
//     duration: '30.05',
//     isPlay: false,
//   },
// ];

// Grouping songs by artist
const groupByArtist = () => {
  const uniqueArtist = listSong
    .map((valueMap) => valueMap.artist)
    .filter(
      (valueFilter, indexFilter, arrayFilter) =>
        arrayFilter.indexOf(valueFilter) === indexFilter
    );
  // Find list song by genre
  const mapingArtist = uniqueArtist.map((valueArtist, indexArtist) => {
    const groupingArtist = listSong.filter(
      (valueSong) => valueSong.artist === valueArtist
    );
    return {
      artist: valueArtist,
      songs: JSON.stringify(groupingArtist, null, 2),
    };
  });

  return mapingArtist;
};

// Grouping songs by genre
const groupByGenre = () => {
  // Get unique genre
  const uniqueGenre = listSong
    .map((valueMap) => valueMap.genre)
    .filter(
      (valueFilter, indexFilter, arrayFilter) =>
        arrayFilter.indexOf(valueFilter) === indexFilter
    );
  // Find list song by genre
  const mapingGenre = uniqueGenre.map((valueGenre, indexGenre) => {
    const groupingGenre = listSong.filter(
      (valueSong) => valueSong.genre === valueGenre
    );
    return {
      genre: valueGenre,
      songs: JSON.stringify(groupingGenre, null, 2),
    };
  });

  return mapingGenre;
};

// Calculate duration max 1 hour
// const groupSongByMaxDuration1Hour = () => {
//   let initialDurationMinute = 0;
//   let initialDurationSecond = 0;
//   let remainingReduction = 0;
//   // Get the duration all list song
//   const filterSong = listSong.filter((valueDuration, index) => {
//     const duration = valueDuration.duration;
//     const minuteOfSong = parseInt(duration.split('.')[0]);
//     const secondOfSong = parseInt(duration.split('.')[1]);
//     initialDurationSecond += secondOfSong;
//     initialDurationMinute += minuteOfSong;
//     // console.log(`MINUTE : ${initialDurationMinute}, SECOND : ${initialDurationSecond}`)
//     if (initialDurationSecond >= 60) {
//       initialDurationMinute += 1;
//       // console.log(`index ${index} : originalSecond ${initialDurationSecond}: remain second ${remainingReduction} : minutes ${initialDurationMinute}`);
//       remainingReduction = initialDurationSecond - 60;
//       // console.log(`index ${index} : remain second ${remainingReduction} : minutes ${initialDurationMinute}`);
//       initialDurationSecond = remainingReduction;

//       if (initialDurationMinute > 60 && initialDurationSecond > 0) {
//         // console.log('YES MINUTES', initialDurationMinute);
//         // console.log(minuteOfSong);
//         // console.log(initialDurationMinute)
//         return false;
//       }

//       return valueDuration;
//     } else {
//       // console.log(initialDurationMinute)
//       if (initialDurationMinute === 60 && initialDurationSecond > 0)
//         return false;
//       return valueDuration;
//     }
//   });
//   return filterSong;
// };

const groupSongByMaxDuration1Hour = (songsParam) => {
  let initialDurationSecond = 0;
  const maxLength = 60 * 60;
  let finalDuration = 0;
  let randomKeyId = [];
  // songsParam.forEach((valueForEach, index) => {
  //   const random = songsParam[Math.floor(Math.random() * index)];
  //   console.log('random', random)
  //   // valueForEach.id.toString().includes(random.id)
  //   //   ? randomKeyId.push(false)
  //   //   : randomKeyId.push(random);
  // });
  // console.log('random', songsParam[Math.floor(Math.random() * songsParam.length)])

  // Looping for initial random key
  songsParam.forEach((valueSong) => {
    // Set random data by id
    const random = songsParam[Math.floor(Math.random() * songsParam.length)];
    // If have't data in array randomKeyId, then push it for initialization
    if (!randomKeyId.length) {
      randomKeyId.push(random);
    } else {
      // Check is array from variable randomKeyId already have same data
      const containObject = randomKeyId.some((valueSome) => {
        return valueSome.id === random.id;
      });

      // If contain same data, push it to false, if not push the data
      if (containObject) {
        randomKeyId.push(false);
      } else {
        randomKeyId.push(random);
      }
    }
  });

  // Find filter when the value in random key is not false
  const filteringTheRandomId = randomKeyId.filter((valueFilter) => valueFilter);

  // Looping for remaining data
  songsParam.forEach((valueAnotherSong) => {
    // Check the duplicate data from randomKeyId with original array
    const isDuplicate = randomKeyId.some((valueSome) => {
      return valueSome.id === valueAnotherSong.id;
    });

    // If not duplicate, push the data, if duplicate push false
    if (!isDuplicate) {
      randomKeyId.push(valueAnotherSong);
    } else {
      randomKeyId.push(false);
    }
  });

  // Filtering value in randomKeyId where is not false
  const finalResultArray = randomKeyId.filter((valueFilter) => valueFilter);

  // Get the duration all list song
  const filterSong = finalResultArray.filter((valueDuration, index) => {
    // Set data duration from looping in variable duration
    const duration = valueDuration.duration;
    // Get the minute
    const minuteOfSong = parseInt(duration.split('.')[0]);
    // Get the second
    const secondOfSong = parseInt(duration.split('.')[1]);
    // Convert the minute to second
    const convertMinutesToSecond = minuteOfSong * 60;
    // Calculate duration with unit of seconds
    const totalDurationSecondPerSong = convertMinutesToSecond + secondOfSong;
    // Set the initial variable for duration to result from calculate second
    initialDurationSecond += totalDurationSecondPerSong;

    // If duration less or equal than 1 hour, return the value, otherwise return false
    if (initialDurationSecond <= maxLength) {
      finalDuration = initialDurationSecond;
      return valueDuration;
    }

    return false;
  });

  // Add the total duration from that calculating
  filterSong.push({ totalDuration: finalDuration, max: maxLength });
  return filterSong;
};

// console.log('Search by artist name', groupByArtist());
// console.log('');
// console.log('------------------------------------------');
// console.log('');
// console.log('Search by genre', groupByGenre());
// console.log('');
// console.log('------------------------------------------');
// console.log('');
console.log(
  'List song with max 1 hour is',
  groupSongByMaxDuration1Hour(listSong)
);
